webpackJsonp([8],{"2O8H":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("fZjL"),s=e.n(i),n=e("Xxa5"),o=e.n(n),l=e("exGp"),r=e.n(l),d=e("Dd8w"),c=e.n(d),u=e("mvHQ"),m=e.n(u),p=e("woOf"),v=e.n(p),f=e("PJh5"),b=e.n(f);b.a.locale("id");var h={name:"proses-capex",components:{CapexNode:function(){return e.e(9).then(e.bind(null,"nmLN"))}},data:function(){return{isLoading:!1,fullscreen:!1,config:{title:"Proses CAPEX",permission:{read:"template-allow-all"}},momentFormat:{stringify:function(t){return t?b()(t).format("YYYY"):""},parse:function(t){return t?b()(t,"YYYY").toDate():null}},searchFilter:"",globalFilter:{},mainData:[],mainForm:{},moduleList:[{id:"PC",label:"Proses CAPEX",export:null,import:null,queue:null,permission:null,dataset:[{id:"pcdt",endpoint:"custom/process-capex",label:"",type:"component",pk:"project_name",fields:[{data:"item_name",label:"Uraian",isMoney:!1,class:"sl",action:!0}],monthly:{data:"data_series_months",header:"periode_month",parse:"longMonth",pipe:"number",isMoney:!0,isPercent:!1},total:!0,subtotal:!0}]}],moduleDataset:{PC:{division:{disabled:!1,api:"divisions"}}},activeModule:null,datasetList:{division:{allowNull:"Semua Divisi",disabled:!0,api:null,param:{sort:"ASC",sort_by:"division_id"},option:{label:"division_name",code:"id"},data:[],target:"division_id"},agenda:{disabled:!1,api:null,param:null,option:null,data:[],target:null},scenario:{disabled:!1,api:null,param:null,option:null,data:[{code:"pesimist",label:"Skenario Pesimis"},{code:"moderate",label:"Skenario Moderat"},{code:"optimist",label:"Skenario Optimis"}],target:null}},isUploading:!1,uploadMax:1,uploadLimitExceed:!1,uploadError:null,uploadPercentage:0,tableConfig:[],queueKey:0}},watch:{mainForm:{deep:!0,immediate:!1,handler:function(t){if(t){var a=v()({},this.globalFilter,{agenda_id:t.agenda_id.code,division_id:t.division_id.code,periode_year:b()(b()(t.periode_year,"YYYY").toDate()).format("YYYY-MM-DD"),scenario_input:t.scenario_input.code});this.datasetList.division.disabled&&delete a.division_id,m()(a)!==m()(this.globalFilter)&&(this.globalFilter=v()({},a))}}},activeModule:{deep:!1,immediate:!0,handler:function(t){this.moduleDataset[t]&&(this.$set(this.datasetList,"division",c()({},this.datasetList.division,this.moduleDataset[t].division)),this.getDataset(),this.queueKey++)}},globalFilter:{deep:!0,immediate:!1,handler:function(t){this.activeModule?this.moduleDataset[this.activeModule].division.disabled?this.getMainData(t):t.division_id?this.getMainData(t):this.datasetList.division.allowNull&&this.getMainData(t):console.log("no active Modules",this.activeModule)}}},mounted:function(){var t=this;return r()(o.a.mark(function a(){return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t.$_sys.togleClass("kt_body","aside-minimize",!0),t.$store.commit("set",["sideNavSecondary",!1]),a.next=4,t.getDataset("PC");case 4:case"end":return a.stop()}},a,t)}))()},methods:{staticDataset:function(){for(var t=[],a=0;a<13;a++){var e=-Math.abs(a);t.push({label:0===a?"RKAP":"Stress Test "+b()().set("date",1).set("month",a-1).format("MMMM"),code:0===a?a:e})}this.$set(this.datasetList.agenda,"data",t),this.$set(this.mainForm,"agenda_id",t[0]),this.$set(this.mainForm,"scenario_input",this.datasetList.scenario.data[1])},getDataset:function(){var t=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return r()(o.a.mark(function e(){var i,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(a&&(t.activeModule=a),t.mainForm=v()({},{division_id:{label:null,code:null},periode_year:b()().set("date",1).set("month",0).format("YYYY"),agenda_id:{label:null,code:null},scenario_input:{label:null,code:null}}),i=function(a){var e=s()(t.datasetList)[a];t.datasetList[e].api?t.$_api.dataset(t.datasetList[e].api,t.datasetList[e].param).then(function(a){var i=a.data.map(function(a){return{label:a[t.datasetList[e].option.label],code:a[t.datasetList[e].option.code],data:a}});t.datasetList[e].allowNull&&i.unshift({label:t.datasetList[e].allowNull,code:null}),t.$set(t.datasetList[e],"data",i),t.datasetList[e].target&&i.length&&t.$set(t.mainForm,t.datasetList[e].target,i[0])},function(a){t.$_alert.error(a)}):t.$set(t.mainForm,t.datasetList[e].target,{label:null,code:null})},n=0;n<s()(t.datasetList).length;n++)i(n);return e.next=6,t.staticDataset();case 6:case"end":return e.stop()}},e,t)}))()},downloadImport:function(){var t=this;this.isLoading=!0;var a=this.moduleList.filter(function(a){return a.id===t.activeModule})[0],e=this.mainForm.division_id.data.division_code;e+="_"+a.id,e+=0===this.globalFilter.agenda_id?"_RKAP":"_ST-"+b()().set("date",1).set("month",Math.abs(this.globalFilter.agenda_id)-1).format("MMM")+"_"+this.mainForm.scenario_input.code,e+="_"+b()(this.globalFilter.periode_year).format("YYYY"),this.$_api.downloadFile(a.export,this.globalFilter,e+".xlsx").then(function(a){t.isLoading=!1},function(a){t.isLoading=!1,t.$_alert.error(a)})},formatDate:function(t){var a=void 0;switch(t){case"date":case"date-range":a="YYYY-MM-DD";break;case"datetime":case"datetime-range":a="YYYY-MM-DD HH:mm:ss";break;case"year":case"year-range":a="YYYY";break;case"month":case"month-range":a="YYYY-MM-DD";break;case"time":case"time-range":a="HH:mm:ss";break;case"week":case"week-range":a="DD"}return a},getMainData:function(t){var a=this;return r()(o.a.mark(function e(){var i,s,n,l;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.mainData=[],a.isLoading=!0,(i=v()({},t)).scenario_input=0===i.agenda_id?"rkap":i.scenario_input,!((s=a.moduleList.filter(function(t){return t.id===a.activeModule})[0]).dataset.length>1)){e.next=16;break}n=o.a.mark(function t(e){var n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=s.dataset[e],t.next=3,a.$_api.dataset(n.endpoint,i).then(function(t){t.label=n.label,t.config=n,a.mainData.push(t)},function(t){a.$_alert.error(t)});case 3:case"end":return t.stop()}},t,a)}),l=0;case 8:if(!(l<s.dataset.length)){e.next=13;break}return e.delegateYield(n(l),"t0",10);case 10:l++,e.next=8;break;case 13:a.isLoading=!1,e.next=17;break;case 16:a.$_api.dataset(s.dataset[0].endpoint,i).then(function(t){t.label=s.dataset[0].label,t.config=s.dataset[0],a.mainData.push(t),a.isLoading=!1},function(t){a.isLoading=!1,a.$_alert.error(t)});case 17:case"end":return e.stop()}},e,a)}))()}}},_={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"container position-relative"},[e("b-overlay",{attrs:{"no-wrap":"",show:t.isLoading,rounded:"sm"}}),t._v(" "),t.moduleList.length>1?e("div",{staticClass:"mb-3"},[t._l(t.moduleList,function(a,i){return[e("button",{key:i+"-modules",staticClass:"btn font-weight-bold font-size-md mr-3 py-4 min-w-150px",class:t.activeModule===a.id?"btn-primary":"btn-link-primary",on:{click:function(e){t.activeModule=a.id}}},[t._v(t._s(a.label))])]})],2):t._e(),t._v(" "),e("div",{staticClass:"row mb-3"},[e("div",{staticClass:"col-5 pr-md-0"},[e("div",{staticClass:"card card-custom card-stretch"},[e("div",{staticClass:"card-body"},[e("div",{staticClass:"row"},[e("div",{staticClass:"form-group position-relative col-12 mb-5"},[e("span",{staticClass:"d-block mb-2 font-weight-bolder",attrs:{for:""}},[t._v("Pilih Divisi / AP")]),t._v(" "),e("v-select",{staticClass:"vs-style custom",attrs:{disabled:t.datasetList.division.disabled,clearable:!1,appendToBody:!0,options:t.datasetList.division.data,placeholder:"Pilih salah satu Divisi"},model:{value:t.mainForm.division_id,callback:function(a){t.$set(t.mainForm,"division_id",a)},expression:"mainForm.division_id"}},[t._t("no-options",function(){return[t._v(t._s(t.$t("error.no_data")))]})],2),t._v(" "),e("b-overlay",{attrs:{"no-wrap":"",show:t.activeModule&&t.datasetList.division.disabled,"z-index":9,rounded:"sm",opacity:.95},scopedSlots:t._u([{key:"overlay",fn:function(){return[e("div",{staticClass:"d-flex flex-fill align-items-center justify-content-center font-weight-bold min-w-350px"},[e("i",{staticClass:"ri-lock-line ri-2x font-weight-bold text-danger"}),t._v(" "),e("span",{staticClass:"flex-fill pl-2"},[t._v("Tidak ada Divisi / AP di "+t._s(t.moduleList.filter(function(a){return a.id===t.activeModule})[0].label)+" ")])])]},proxy:!0}])})],1),t._v(" "),e("div",{staticClass:"form-group col-12 mb-0"},[e("span",{staticClass:"d-block mb-2 font-weight-bolder",attrs:{for:""}},[t._v("Tahun")]),t._v(" "),e("date-picker",{attrs:{clearable:!1,"input-attr":{autocomplete:"off"},type:"year","input-class":"form-control custom-dateyears","value-type":t.formatDate("year"),formatter:t.momentFormat},model:{value:t.mainForm.periode_year,callback:function(a){t.$set(t.mainForm,"periode_year",a)},expression:"mainForm.periode_year"}})],1)])])])]),t._v(" "),e("div",{staticClass:"col"},[e("div",{staticClass:"card card-custom card-stretch"},[e("div",{staticClass:"card-body"},[e("div",{staticClass:"row no-gutters align-items-center"},[e("div",{staticClass:"col p-0"},[e("div",{staticClass:"form-group mb-5"},[e("span",{staticClass:"d-block mb-2 font-weight-bolder",attrs:{for:""}},[t._v("Pilih Agenda Input")]),t._v(" "),e("v-select",{staticClass:"vs-style custom",attrs:{disabled:!1,clearable:!1,appendToBody:!0,options:t.datasetList.agenda.data,placeholder:"Pilih salah satu Agenda"},model:{value:t.mainForm.agenda_id,callback:function(a){t.$set(t.mainForm,"agenda_id",a)},expression:"mainForm.agenda_id"}},[t._t("no-options",function(){return[t._v(t._s(t.$t("error.no_data")))]})],2)],1),t._v(" "),e("div",{staticClass:"form-group position-relative mb-0"},[e("span",{staticClass:"d-block mb-1 font-weight-bolder",attrs:{for:""}},[t._v("Pilih Skenario Input")]),t._v(" "),e("div",{staticClass:"checkbox-inline py-2"},t._l(t.datasetList.scenario.data,function(a,i){return e("label",{key:i+"-form-a",staticClass:"checkbox checkbox-lg checkbox-outline mb-1"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.mainForm.scenario_input,expression:"mainForm.scenario_input"}],attrs:{disabled:0===t.globalFilter.agenda_id,type:"radio"},domProps:{value:a,checked:t._q(t.mainForm.scenario_input,a)},on:{change:function(e){return t.$set(t.mainForm,"scenario_input",a)}}}),t._v(" "),e("span"),t._v(t._s(a.label))])}),0),t._v(" "),e("b-overlay",{attrs:{"no-wrap":"",show:0===t.globalFilter.agenda_id,"z-index":9,rounded:"sm",opacity:.95},scopedSlots:t._u([{key:"overlay",fn:function(){return[e("div",{staticClass:"d-flex flex-fill align-items-center justify-content-center font-weight-bold min-w-350px"},[e("i",{staticClass:"ri-lock-line ri-2x font-weight-bold text-danger"}),t._v(" "),e("span",{staticClass:"flex-fill pl-2"},[t._v("Tidak ada Skenario Input di RKAP")])])]},proxy:!0}])})],1)])])])])])]),t._v(" "),e("div",{staticClass:"position-relative",class:t.fullscreen?"fullscreen-component":""},[e("div",{staticClass:"card card-custom"},[e("div",{staticClass:"card-header border-0 p-5",staticStyle:{"min-height":"50px"}},[e("div",{staticClass:"d-flex flex-fill flex-wrap align-items-center justify-content-between"},[e("div",{staticClass:"flex-fill"},[e("h3",{staticClass:"card-title font-weight-bolder text-dark "},[t._v(t._s(t.config.title)+" "),t.moduleList.length>1&&t.activeModule?[t._v(" - "+t._s(t.moduleList.filter(function(a){return a.id===t.activeModule})[0].label))]:t._e()],2)]),t._v(" "),e("div",{staticClass:"d-flex flex-wrap align-items-center"},[e("a",{staticClass:"btn btn-link text-primary mr-1",on:{click:function(a){t.fullscreen=!t.fullscreen}}},[e("i",{staticClass:"text-primary",class:t.fullscreen?"ri-fullscreen-exit-line":"ri-fullscreen-line"}),t._v(" "),e("span",[t._v("Fullscreen")])])])])]),t._v(" "),e("div",{staticClass:"card-body px-5 pt-0 pb-0"},[e("b-tabs",{attrs:{"content-class":t.mainData.length>1?"mt-3":"mt-0","nav-wrapper-class":t.mainData.length>1?"":"d-none","active-nav-item-class":"active-nav-title font-weight-bolder text-primary"}},t._l(t.mainData,function(a,i){return e("b-tab",{key:i+"-table-data",attrs:{title:a.label,active:""}},[a.data.length?e("div",{staticClass:"table-responsive sticky-table"},[e("table",{staticClass:"table table-head-custom table-bordered table-vertical-cente table-input"},t._l(a.data,function(t,a){return e("capex-node",{key:a+"-loop-data",attrs:{row:t}})}),1)]):t._e()])}),1)],1)])])],1)},staticRenderFns:[]};var g=e("VU/8")(h,_,!1,function(t){e("9rtI"),e("4Bhf")},"data-v-029f090b",null);a.default=g.exports},"4Bhf":function(t,a){},"9rtI":function(t,a){}});
//# sourceMappingURL=8.16b218cfc9630db7051d.js.map